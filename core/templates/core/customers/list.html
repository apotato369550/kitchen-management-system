{% extends 'accounts/base.html' %}

{% block title %}Customers - Kitchen Management System{% endblock %}

{% block content %}
<div class="page-header">
    <div class="page-title-group">
        <h1>Customers</h1>
        <p>Manage customer information</p>
    </div>
    <div class="page-actions">
        <a href="{% url 'customer_create' %}" class="btn btn-primary">Add Customer</a>
    </div>
</div>

<div class="content-container">
    <!-- Search -->
    <div class="card" style="margin-bottom: 24px;">
        <div class="card-body">
            <form method="get" style="display: flex; gap: 12px; flex-wrap: wrap; align-items: flex-end;">
                <div style="flex: 1; min-width: 150px;">
                    <label class="form-label">Search:</label>
                    <input type="text" name="search" value="{{ search }}" placeholder="Name or contact..." class="form-input">
                </div>
                <button type="submit" class="btn btn-primary">Search</button>
                {% if search %}
                <a href="{% url 'customer_list' %}" class="btn btn-secondary">Clear</a>
                {% endif %}
            </form>
        </div>
    </div>

    <!-- Desktop Table -->
    {% if customers %}
    <div class="table-wrapper desktop-only">
        <table>
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Contact</th>
                    <th>Orders</th>
                    <th>Created</th>
                    <th style="text-align: right;">Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for customer in customers %}
                <tr>
                    <td>
                        <a href="{% url 'customer_detail' customer.pk %}" style="color: var(--primary-600); font-weight: 500;">
                            {{ customer.name }}
                        </a>
                    </td>
                    <td>{{ customer.contact_info|default:"â€”" }}</td>
                    <td>{{ customer.purchase_orders.count }}</td>
                    <td>{{ customer.created_at|date:"M d, Y" }}</td>
                    <td style="text-align: right;">
                        <a href="{% url 'customer_detail' customer.pk %}" class="btn btn-sm btn-primary" style="margin-right: 8px;">View</a>
                        <a href="{% url 'customer_edit' customer.pk %}" class="btn btn-sm btn-secondary" style="margin-right: 8px;">Edit</a>
                        <a href="{% url 'customer_delete' customer.pk %}" class="btn btn-sm btn-danger">Delete</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Mobile Card List -->
    <div class="mobile-only">
        {% for customer in customers %}
        <div class="list-card">
            <div class="list-card-header">
                <a href="{% url 'customer_detail' customer.pk %}" style="color: var(--primary-600); font-weight: 600; text-decoration: none;">
                    {{ customer.name }}
                </a>
                <span class="badge badge-info">{{ customer.purchase_orders.count }} orders</span>
            </div>
            <div class="list-card-body">
                {% if customer.contact_info %}
                <div class="list-field">
                    <span class="list-field-label">Contact:</span>
                    <span class="list-field-value">{{ customer.contact_info }}</span>
                </div>
                {% endif %}
                <div class="list-field">
                    <span class="list-field-label">Added:</span>
                    <span class="list-field-value">{{ customer.created_at|date:"M d, Y" }}</span>
                </div>
            </div>
            <div class="list-card-actions">
                <a href="{% url 'customer_detail' customer.pk %}" class="btn btn-primary btn-sm">View</a>
                <a href="{% url 'customer_edit' customer.pk %}" class="btn btn-secondary btn-sm">Edit</a>
                <a href="{% url 'customer_delete' customer.pk %}" class="btn btn-danger btn-sm">Delete</a>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="empty-state">
        <svg class="empty-state-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
        </svg>
        <div class="empty-state-title">No customers</div>
        <div class="empty-state-description">Add your first customer to get started.</div>
        <a href="{% url 'customer_create' %}" class="btn btn-primary empty-state-action">Add Customer</a>
    </div>
    {% endif %}
</div>
{% endblock %}
